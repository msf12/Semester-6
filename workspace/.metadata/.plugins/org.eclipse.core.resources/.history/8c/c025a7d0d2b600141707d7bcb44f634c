import java.io.File;
import java.io.FileNotFoundException;
import java.util.HashMap;
import java.util.Map;
import java.util.Scanner;


public class Scheduler {

	public static void main(String[] args) throws FileNotFoundException {
		if(args.length < 1)
			throw new IllegalArgumentException();
		Scanner scan = new Scanner(new File(args[0]));
		Map<Integer,Integer> jobs = new HashMap<Integer,Integer>();
		Map<Integer,Integer> jobs2 = new HashMap<Integer,Integer>();
		Map<Integer,Integer> jobs3 = new HashMap<Integer,Integer>();
		Map<Integer,Integer> jobs4 = new HashMap<Integer,Integer>();
		while(scan.hasNextLine())
		{
			String[] nextJob = scan.nextLine().split(",");
			if(nextJob[0].charAt(0) == '#')
				continue;
			
			int pid = Integer.parseInt(nextJob[0]);
			int jobTime = Integer.parseInt(nextJob[1]);
			System.out.println(pid + "," + jobTime);
			
			jobs.put(pid, jobTime);
			jobs2.put(pid, jobTime);
			jobs3.put(pid, jobTime);
			jobs4.put(pid, jobTime);
		}
		System.out.println("\nFCFS");
		FCFS(jobs);
		System.out.println("\nRR");
		RR(jobs2);
		System.out.println("\nRR (Time Quantum = 10)");
		RR(jobs3,10);
		scan.close();
	}
	
	public static void FCFS(Map<Integer,Integer> jobs)
	{
		int totalWaitTime = 0;
		int totalCompletionTime = 0;
		int timeElapsed = 0;
		for(int i = 0; i <= jobs.size(); i++)
		{
			if(!jobs.containsKey(i))
				continue;
			int timeToComplete = jobs.get(i);
			totalWaitTime += timeElapsed;
			timeElapsed += timeToComplete;
			totalCompletionTime += timeElapsed;
//			System.out.println("Job: " + i + 
//					", Turnaround time: " + timeElapsed +
//					", Total time elapsed: " + timeElapsed);
		}
		SchedStats(jobs.size(),timeElapsed,totalCompletionTime,totalWaitTime);
	}
	
	public static void RR(Map<Integer,Integer> jobs)
	{
		RR(jobs, 1);
	}
	
	public static void RR(Map<Integer,Integer> jobs, int quantum)
	{
		int totalWaitTime = 0;
		int totalCompletionTime = 0;
		int timeElapsed = 0;
		int totalJobs = jobs.size();
		
		final int TIME_QUANTUM = quantum;
		
		while(jobs.size() > 0)
		{
			for(int i = 0; i <= totalJobs; i++)
			{
				if(!jobs.containsKey(i))
					continue;

				int timeToComplete = jobs.get(i);
				if(timeToComplete <= TIME_QUANTUM)
				{
					totalWaitTime += timeElapsed;
					jobs.remove(i);
					timeElapsed += timeToComplete;
					totalCompletionTime += timeElapsed;
				}
				else
				{
					totalWaitTime-=TIME_QUANTUM; //every time a job is run the time that job spends running is not counted
					jobs.put(i, timeToComplete-TIME_QUANTUM);
					timeElapsed += TIME_QUANTUM;
				}
			}
		}
		SchedStats(totalJobs,timeElapsed,totalCompletionTime,totalWaitTime);
	}
	
	public static void SJF(Map<Integer,Integer> j)
	{
		int[] jobs = new int[j.size()+1]; //leaving room for if the PIDs start at 0 or 1
		
		for(int i = 0; i <= j.size(); i++)
		{
			if(!j.containsKey(i))
				continue;
			jobs[i] = j.get(i);
		}
	}
	
	public static void SchedStats(int nJobs, int tElapsed, int tCompletionTime, int tWaitTime)
	{
		double numJobs = nJobs;
		double timeElapsed = tElapsed;
		double totalWaitTime = tWaitTime;
		double totalCompletionTime = tCompletionTime;
		System.out.println("Average turnaround: " + totalCompletionTime/numJobs + " seconds/job" + 
				"\nAverage wait time: " + totalWaitTime/numJobs + " seconds" +
				"\nThroughput: " + timeElapsed/60.0 + " jobs/minute");
	}

}
