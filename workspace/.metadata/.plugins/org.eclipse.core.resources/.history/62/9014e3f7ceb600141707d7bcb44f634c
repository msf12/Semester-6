import java.io.File;
import java.io.FileNotFoundException;
import java.util.HashMap;
import java.util.Map;
import java.util.Scanner;


public class Scheduler {

	public static void main(String[] args) throws FileNotFoundException {
		if(args.length < 1)
			throw new IllegalArgumentException();
		Scanner scan = new Scanner(new File(args[0]));
		Map<Integer,Integer> jobs = new HashMap<Integer,Integer>();
		while(scan.hasNextLine())
		{
			String[] nextJob = scan.nextLine().split(",");
			if(nextJob[0].charAt(0) == '#')
				continue;
			
			int pid = Integer.parseInt(nextJob[0]);
			int jobTime = Integer.parseInt(nextJob[1]);
			System.out.println(pid + "," + jobTime);
			
			jobs.put(pid, jobTime);
		}
		System.out.println("FCFS");
		FCFS(jobs);
//		System.out.println("\nRR");
//		RR(jobs);
		scan.close();
	}
	
	public static void FCFS(Map<Integer,Integer> jobs)
	{
		int totalWaitTime = 0;
		int timeElapsed = 0;
		for(int i = 0; i <= jobs.size(); i++)
		{
			if(!jobs.containsKey(i))
				continue;
			int timeToComplete = jobs.get(i);
			totalWaitTime += timeElapsed;
			timeElapsed += timeToComplete;
			System.out.println("Job: " + i + 
					", Turnaround time: " + timeToComplete +
					", Total time elapsed: " + timeElapsed);
		}
		SchedStats(jobs.size(),timeElapsed,totalWaitTime);
	}
	
	public static void RR(Map<Integer,Integer> jobs)
	{
		int totalWaitTime = 0;
		int timeElapsed = 0;
		int totalJobs = jobs.size();
		
		final int TIME_QUANTUM = 1;
		
		for(int i = 0; i <= totalJobs; i++)
		{
			if(!jobs.containsKey(i))
				continue;
			
			int timeToComplete = jobs.get(i);
			if(timeToComplete <= TIME_QUANTUM)
			{
				totalWaitTime += timeElapsed+timeToComplete;
				jobs.remove(i);
				timeElapsed += timeToComplete;
			}
			else
			{
				jobs.put(i, timeToComplete-TIME_QUANTUM);
				timeElapsed += TIME_QUANTUM;
			}
//			System.out.println("Job: " + i + 
//					", Turnaround time: " + timeToComplete +
//					", Total time elapsed: " + timeElapsed);
		}
		SchedStats(jobs.size(),timeElapsed,totalWaitTime);
	}
	
	public static void SchedStats(int nJobs, int tElapsed, int tWaitTime)
	{
		double numJobs = nJobs;
		double timeElapsed = tElapsed;
		int totalWaitTime = tWaitTime;
		System.out.println("Average turnaround: " + timeElapsed/numJobs + " seconds/job" + 
				"\nAverage wait time: " + totalWaitTime/numJobs + " seconds" +
				"\nThroughput: " + timeElapsed/60.0 + " jobs/minute");
	}

}
